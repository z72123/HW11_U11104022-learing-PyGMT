<!DOCTYPE html>
<html lang="zh-TW" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PyGMT 探險隊：互動實作實驗室</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&family=Fredoka:wght@400;600&family=Fira+Code:wght@500&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary: #0ea5e9; /* Sky Blue */
            --radius-lg: 12px;
            --font-code: 'Fira Code', monospace;
        }

        body { font-family: 'Noto Sans TC', sans-serif; background-color: #0f172a; color: #e2e8f0; }
        h1, h2, h3, .fun-font { font-family: 'Fredoka', sans-serif; }

        /* --- 7. 互動實作區 (Interactive Lab) CSS --- */
        section.lab { padding: 60px 0; background-color: #0f172a; }

        .lab-layout {
            display: grid; grid-template-columns: 1fr 1fr; gap: 40px; align-items: start;
        }
        @media(max-width: 900px) { .lab-layout { grid-template-columns: 1fr; } }

        /* IDE 模擬器 */
        .ide-window {
            background: #0d1117;
            border-radius: var(--radius-lg);
            border: 1px solid #30363d;
            box-shadow: 0 20px 50px rgba(0,0,0,0.7);
            font-family: var(--font-code);
            overflow: hidden;
            position: relative;
        }

        .ide-header {
            background: #161b22; padding: 12px 20px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid #30363d;
        }
        .window-controls { display: flex; gap: 8px; }
        .ctrl { width: 12px; height: 12px; border-radius: 50%; }
        .ctrl.cl { background: #ff5f56; } .ctrl.mi { background: #ffbd2e; } .ctrl.ex { background: #27c93f; }
        
        .run-btn {
            background: #238636; color: white; border: none; padding: 6px 16px; border-radius: 6px; cursor: pointer; font-size: 0.85rem; display: flex; align-items: center; gap: 8px; transition: 0.2s; font-weight: 600;
        }
        .run-btn:hover { background: #2ea043; transform: scale(1.05); }
        .run-btn:active { transform: scale(0.95); }
        .run-btn svg { width: 14px; height: 14px; fill: currentColor; }

        .ide-content { padding: 25px; color: #c9d1d9; font-size: 0.95rem; line-height: 1.6; min-height: 350px; white-space: pre; overflow-x: auto; }
        .ln { color: #484f58; margin-right: 20px; user-select: none; font-size: 0.8em; }
        
        /* Syntax Highlighting Colors */
        .k { color: #ff7b72; } /* Keyword (import, def) */
        .f { color: #d2a8ff; } /* Function (coast, show) */
        .s { color: #a5d6ff; } /* String ("TW") */
        .c { color: #8b949e; font-style: italic; } /* Comment */
        .v { color: #79c0ff; } /* Variable/Argument */
        .n { color: #d2a8ff; } /* Number */

        /* 結果顯示區 */
        .result-viewer {
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: var(--radius-lg);
            height: 440px; /* 固定高度以防跳動 */
            display: flex; align-items: center; justify-content: center;
            position: relative;
            background: #1e293b;
            transition: 0.3s;
            overflow: hidden;
        }
        
        .loader {
            width: 50px; height: 50px; 
            border: 4px solid rgba(14, 165, 233, 0.2); 
            border-radius: 50%; 
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite; 
            display: none; /* JS控制 */
        }
        .loader.active { display: block; }

        @keyframes spin { to { transform: rotate(360deg); } }
        
        .final-image {
            max-width: 95%; max-height: 95%; 
            border-radius: 8px; 
            box-shadow: 0 0 40px rgba(0,0,0,0.5);
            opacity: 0; transform: scale(0.9); 
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            display: none; /* JS控制 */
        }
        .final-image.show { opacity: 1; transform: scale(1); display: block; }

        /* 選擇任務按鈕區 */
        .task-selector button {
            transition: all 0.3s;
            border: 1px solid #30363d;
        }
        .task-selector button:hover { border-color: #0ea5e9; }
        .task-selector button.active {
            background: rgba(14, 165, 233, 0.2);
            border-color: #0ea5e9;
            color: #38bdf8;
        }
    </style>
</head>
<body>

    <nav class="fixed w-full z-50 bg-[#0f172a]/90 backdrop-blur shadow-sm py-3 border-b border-white/10">
        <div class="max-w-6xl mx-auto px-4 flex justify-between items-center">
            <div class="flex items-center gap-2 text-blue-400">
                <i class="fa-solid fa-code text-2xl"></i>
                <span class="fun-font text-2xl font-bold tracking-wide">PyGMT <span class="text-white text-base font-normal">Interactive Lab</span></span>
            </div>
            <a href="https://www.pygmt.org/" target="_blank" class="text-sm text-slate-400 hover:text-white transition">
                <i class="fa-solid fa-book-open mr-1"></i> 官方文檔
            </a>
        </div>
    </nav>

    <section class="lab min-h-screen flex items-center justify-center pt-24" x-data="codeLab()">
        <div class="max-w-7xl w-full mx-auto px-6">
            
            <div class="text-center mb-10" data-aos="fade-up">
                <span class="text-blue-400 font-bold tracking-wider text-sm">INTERACTIVE DEMO</span>
                <h2 class="text-4xl font-bold mt-2 text-white">親手寫下第一行魔法</h2>
                <p class="text-slate-400 mt-4 max-w-2xl mx-auto">
                    這裡模擬了真實的 Python 開發環境。選擇一個任務，點擊「執行程式碼 (Run Code)」，看看 PyGMT 如何將文字轉化為圖像。
                </p>
            </div>

            <div class="flex flex-wrap justify-center gap-4 mb-8 task-selector" data-aos="fade-up" data-aos-delay="100">
                <button @click="switchTask('tw')" :class="{'active': currentTask === 'tw'}" class="px-6 py-3 rounded-xl bg-[#1e293b] text-slate-300 font-semibold flex items-center gap-3">
                    <i class="fa-solid fa-map-location-dot"></i> 台灣海岸線
                </button>
                <button @click="switchTask('world')" :class="{'active': currentTask === 'world'}" class="px-6 py-3 rounded-xl bg-[#1e293b] text-slate-300 font-semibold flex items-center gap-3">
                    <i class="fa-solid fa-earth-americas"></i> 全球地形圖
                </button>
                <button @click="switchTask('pacific')" :class="{'active': currentTask === 'pacific'}" class="px-6 py-3 rounded-xl bg-[#1e293b] text-slate-300 font-semibold flex items-center gap-3">
                    <i class="fa-solid fa-water"></i> 太平洋視角
                </button>
            </div>

            <div class="lab-layout" data-aos="fade-up" data-aos-delay="200">
                
                <div class="ide-window flex flex-col">
                    <div class="ide-header">
                        <div class="window-controls">
                            <div class="ctrl cl"></div>
                            <div class="ctrl mi"></div>
                            <div class="ctrl ex"></div>
                            <span class="ml-3 text-xs text-slate-500 font-mono">script.py</span>
                        </div>
                        <button class="run-btn" @click="runCode()" :disabled="isLoading">
                            <i class="fa-solid fa-play" x-show="!isLoading"></i>
                            <i class="fa-solid fa-spinner fa-spin" x-show="isLoading"></i>
                            <span x-text="isLoading ? 'Running...' : 'Run Code'"></span>
                        </button>
                    </div>
                    
                    <div class="ide-content" x-html="tasks[currentTask].codeHtml"></div>
                    
                    <div class="bg-[#161b22] px-4 py-1 text-[10px] text-slate-500 flex justify-between border-t border-[#30363d]">
                        <span>Python 3.9 (PyGMT Environment)</span>
                        <span>Ln 10, Col 1</span>
                    </div>
                </div>

                <div class="result-viewer">
                    
                    <div x-show="!hasRun && !isLoading" class="text-center text-slate-500">
                        <i class="fa-solid fa-terminal text-4xl mb-4 opacity-50"></i>
                        <p>等待執行...</p>
                        <p class="text-xs mt-2 opacity-60">點擊左上角的 "Run Code"</p>
                    </div>

                    <div class="loader" :class="{'active': isLoading}"></div>

                    <img :src="tasks[currentTask].imgUrl" 
                         alt="Generated Map" 
                         class="final-image" 
                         :class="{'show': hasRun && !isLoading}"
                         @load="imageLoaded = true">
                    
                    <div x-show="hasRun && !isLoading" class="absolute bottom-4 right-4 bg-green-500/20 text-green-400 px-3 py-1 rounded text-xs border border-green-500/30 flex items-center gap-2">
                        <i class="fa-solid fa-check"></i> 繪製完成 (0.8s)
                    </div>
                </div>

            </div>
        </div>
    </section>

    <script>
        document.addEventListener('alpine:init', () => {
            Alpine.data('codeLab', () => ({
                currentTask: 'tw',
                isLoading: false,
                hasRun: false,
                
                // 定義任務資料 (程式碼 HTML 與 結果圖)
                tasks: {
                    'tw': {
                        imgUrl: 'https://docs.pygmt.org/latest/_images/gallery_18_coast_land_001.png', // 範例圖
                        codeHtml: `
<span class="ln">1</span><span class="k">import</span> pygmt
<span class="ln">2</span>
<span class="ln">3</span><span class="c"># 建立畫布</span>
<span class="ln">4</span>fig = pygmt.<span class="f">Figure</span>()
<span class="ln">5</span>
<span class="ln">6</span><span class="c"># 繪製台灣周邊 (TW)</span>
<span class="ln">7</span>fig.<span class="f">coast</span>(
<span class="ln">8</span>    <span class="v">region</span>=<span class="s">"TW"</span>,         <span class="c"># 設定範圍：台灣</span>
<span class="ln">9</span>    <span class="v">projection</span>=<span class="s">"M12c"</span>,   <span class="c"># 設定投影：麥卡托</span>
<span class="ln">10</span>   <span class="v">land</span>=<span class="s">"lightgray"</span>,    <span class="c"># 陸地顏色</span>
<span class="ln">11</span>   <span class="v">water</span>=<span class="s">"azure"</span>,       <span class="c"># 海洋顏色</span>
<span class="ln">12</span>   <span class="v">shorelines</span>=<span class="s">"1p"</span>,     <span class="c"># 海岸線粗細</span>
<span class="ln">13</span>   <span class="v">frame</span>=<span class="k">True</span>
<span class="ln">14</span>)
<span class="ln">15</span>
<span class="ln">16</span>fig.<span class="f">show</span>()`
                    },
                    'world': {
                        imgUrl: 'https://docs.pygmt.org/latest/_images/gallery_06_grdview_surface_001.png',
                        codeHtml: `
<span class="ln">1</span><span class="k">import</span> pygmt
<span class="ln">2</span>
<span class="ln">3</span>fig = pygmt.<span class="f">Figure</span>()
<span class="ln">4</span>
<span class="ln">5</span><span class="c"># 繪製全球地形數據</span>
<span class="ln">6</span>fig.<span class="f">grdimage</span>(
<span class="ln">7</span>    <span class="v">grid</span>=<span class="s">"@earth_relief_20m"</span>,  <span class="c"># 下載地形資料</span>
<span class="ln">8</span>    <span class="v">projection</span>=<span class="s">"R12c"</span>,         <span class="c"># 溫克爾投影</span>
<span class="ln">9</span>    <span class="v">cmap</span>=<span class="s">"geo"</span>,                <span class="c"># 地形配色</span>
<span class="ln">10</span>   <span class="v">frame</span>=<span class="s">"a"</span>
<span class="ln">11</span>)
<span class="ln">12</span>
<span class="ln">13</span><span class="c"># 加上色彩條</span>
<span class="ln">14</span>fig.<span class="f">colorbar</span>(<span class="v">frame</span>=[<span class="s">"a"</span>, <span class="s">"x+lElevation"</span>])
<span class="ln">15</span>
<span class="ln">16</span>fig.<span class="f">show</span>()`
                    },
                    'pacific': {
                        imgUrl: 'https://docs.pygmt.org/latest/_images/gallery_12_inset_001.png',
                        codeHtml: `
<span class="ln">1</span><span class="k">import</span> pygmt
<span class="ln">2</span>
<span class="ln">3</span>fig = pygmt.<span class="f">Figure</span>()
<span class="ln">4</span>
<span class="ln">5</span><span class="c"># 太平洋中心視角</span>
<span class="ln">6</span>fig.<span class="f">coast</span>(
<span class="ln">7</span>    <span class="v">region</span>=<span class="s">"g"</span>,
<span class="ln">8</span>    <span class="v">projection</span>=<span class="s">"G180/0/12c"</span>, <span class="c"># 正射投影(地球儀)</span>
<span class="ln">9</span>    <span class="v">land</span>=<span class="s">"darkgreen"</span>,
<span class="ln">10</span>   <span class="v">water</span>=<span class="s">"lightblue"</span>,
<span class="ln">11</span>   <span class="v">frame</span>=<span class="s">"g"</span>
<span class="ln">12</span>)
<span class="ln">13</span>
<span class="ln">14</span>fig.<span class="f">show</span>()`
                    }
                },

                switchTask(taskKey) {
                    if(this.isLoading) return;
                    this.currentTask = taskKey;
                    this.hasRun = false; // 切換任務後重置結果
                },

                runCode() {
                    if(this.isLoading) return;
                    
                    this.isLoading = true;
                    this.hasRun = false;

                    // 模擬 Python 執行時間 (1.5秒)
                    setTimeout(() => {
                        this.isLoading = false;
                        this.hasRun = true;
                    }, 1500);
                }
            }))
        })
    </script>
</body>
</html>